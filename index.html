<!DOCTYPE html>
<html lang="ru">
<head>
    <!-- Yandex.Metrika counter -->
<script type="text/javascript">
    (function(m,e,t,r,i,k,a){
        m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
        m[i].l=1*new Date();
        for (var j = 0; j < document.scripts.length; j++) {if (document.scripts[j].src === r) { return; }}
        k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)
    })(window, document,'script','https://mc.yandex.ru/metrika/tag.js?id=106628972', 'ym');

    ym(106628972, 'init', {ssr:true, webvisor:true, clickmap:true, ecommerce:"dataLayer", referrer: document.referrer, url: location.href, accurateTrackBounce:true, trackLinks:true});
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/106628972" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
<!-- /Yandex.Metrika counter -->
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>–ë–µ—Å–ø–æ–ª–µ–∑–Ω—ã–π —Å–∞–π—Ç</title>

<!-- GA4 -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-XXXXXXXXXX"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-XXXXXXXXXX');
</script>

<style>
  html, body {
    margin: 0;
    padding: 0;
    height: 100%;
    overflow: hidden;
    font-family: Arial, sans-serif;
    background: #111;
    color: #fff;
    user-select: none;
  }

  #game {
    position: relative;
    width: 100%;
    height: 100%;
  }

  #mainButton {
    position: absolute;
    width: 120px;
    height: 120px;
    font-size: 16px;
    background: #ffeb3b;
    color: #000;
    border: none;
    border-radius: 50%;
    cursor: pointer;
    touch-action: manipulation;
  }

  #workButton {
    position: fixed;
    bottom: 20px;
    left: 50%;
    transform: translateX(-50%);
    padding: 12px 18px;
    font-size: 16px;
    background: #d50000;
    color: #fff;
    border: none;
    border-radius: 8px;
    cursor: pointer;
  }

  #message {
    position: fixed;
    top: 15px;
    width: 100%;
    text-align: center;
    font-size: 20px;
    opacity: 0.9;
  }

  #stats {
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,0.9);
    display: none;
    align-items: center;
    justify-content: center;
    text-align: center;
    padding: 20px;
    font-size: 20px;
  }
</style>
</head>
<body>

<div id="game">
  <div id="message">–ñ–º—è–∫–∞–π</div>
  <button id="mainButton">–ñ–º—è–∫–∞–π</button>
  <button id="workButton">–Ø –≥–æ—Ç–æ–≤ –∏–¥—Ç–∏ —Ä–∞–±–æ—Ç–∞—Ç—å</button>
</div>

<div id="stats"></div>

<script>
document.addEventListener('DOMContentLoaded', () => {

  const mainButton = document.getElementById('mainButton');
  const workButton = document.getElementById('workButton');
  const message = document.getElementById('message');
  const stats = document.getElementById('stats');

  let missClicks = 0;
  let successClicks = 0;
  let startTime = Date.now();

  /* ---------- AUDIO ---------- */
  let audioCtx = null;
  function initAudio() {
    if (!audioCtx) {
      audioCtx = new (window.AudioContext || window.webkitAudioContext)();
    }
  }

  function playSound(type) {
    if (!audioCtx) return;
    const osc = audioCtx.createOscillator();
    const gain = audioCtx.createGain();
    osc.connect(gain);
    gain.connect(audioCtx.destination);

    osc.frequency.value = type === 'miss' ? 120 : 520;
    osc.type = type === 'miss' ? 'square' : 'triangle';
    gain.gain.value = type === 'miss' ? 0.15 : 0.2;

    osc.start();
    osc.stop(audioCtx.currentTime + 0.12);
  }

  /* ---------- RECORDS ---------- */
  const records = {
    maxHits: Number(localStorage.getItem('maxHits')) || 0,
    maxTime: Number(localStorage.getItem('maxTime')) || 0,
    bestAccuracy: Number(localStorage.getItem('bestAccuracy')) || 0
  };

  function saveRecords(seconds) {
    const attempts = missClicks + successClicks;
    const accuracy = attempts === 0 ? 0 : successClicks / attempts;

    if (successClicks > records.maxHits) {
      records.maxHits = successClicks;
      localStorage.setItem('maxHits', records.maxHits);
    }

    if (seconds > records.maxTime) {
      records.maxTime = seconds;
      localStorage.setItem('maxTime', records.maxTime);
    }

    if (accuracy > records.bestAccuracy) {
      records.bestAccuracy = accuracy;
      localStorage.setItem('bestAccuracy', records.bestAccuracy);
    }
  }

  /* ---------- INSULTS ---------- */
  const insults = [
    "–ú–∏–º–æ", "–ù–µ –ø–æ–ø–∞–ª ü§°", "–†—É–∫–∏ –∏–∑ CSS", "UX —É–º–µ—Ä",
    "–ö–Ω–æ–ø–∫–∞ —Å–º–µ—ë—Ç—Å—è", "–°–∫–∏–ª–ª –Ω–µ –Ω–∞–π–¥–µ–Ω", "–ü—Ä–æ–º–∞—Ö –≤–µ–∫–∞",
    "–ú—ã—à–∫–∞ –ø–ª–∞—á–µ—Ç", "–ê–ª–≥–æ—Ä–∏—Ç–º –ø—Ä–æ—Ç–∏–≤ —Ç–µ–±—è",
    "–≠—Ç–æ –±—ã–ª–æ –æ–ø—Ç–∏–º–∏—Å—Ç–∏—á–Ω–æ", "–ù–µ —Å–µ–≥–æ–¥–Ω—è",
    "–ö–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏—è —É—à–ª–∞", "–§–æ–∫—É—Å –ø–æ—Ç–µ—Ä—è–Ω",
    "–¢—ã –≤–æ–æ–±—â–µ —Å—Ç–∞—Ä–∞–µ—à—å—Å—è?", "–ü–æ—á—Ç–∏. –ù–µ—Ç.",
    "–°—É–¥—å–±–∞ –æ—Ç–≤–µ—Ä–Ω—É–ª–∞—Å—å", "–ö–Ω–æ–ø–∫–∞ –∂–∏–≤—ë—Ç —Å–≤–æ–µ–π –∂–∏–∑–Ω—å—é"
  ];

  const randomInsult = () =>
    insults[Math.floor(Math.random() * insults.length)];

  /* ---------- FLOATING ---------- */
  let posX = 100, posY = 100;
  let velX = 1.2, velY = 1.1;

  function animate() {
    const maxX = window.innerWidth - mainButton.offsetWidth;
    const maxY = window.innerHeight - mainButton.offsetHeight - 80;

    posX += velX;
    posY += velY;

    if (posX <= 0 || posX >= maxX) velX *= -1;
    if (posY <= 0 || posY >= maxY) velY *= -1;

    mainButton.style.left = posX + 'px';
    mainButton.style.top = posY + 'px';

    requestAnimationFrame(animate);
  }

  /* ---------- HOVER (20%) ---------- */
  mainButton.addEventListener('mouseenter', () => {
    if (Math.random() > 0.2) return;

    const diameter = mainButton.offsetWidth;
    const shift = diameter * 3;

    const angle = Math.random() * Math.PI * 2;
    posX += Math.cos(angle) * shift;
    posY += Math.sin(angle) * shift;

    const maxX = window.innerWidth - diameter;
    const maxY = window.innerHeight - diameter - 80;

    posX = Math.max(0, Math.min(maxX, posX));
    posY = Math.max(0, Math.min(maxY, posY));
  });

  /* ---------- CLICKS ---------- */
  document.body.addEventListener('click', () => {
    initAudio();
    missClicks++;
    message.textContent = randomInsult();
    playSound('miss');
  });

  mainButton.addEventListener('click', (e) => {
    e.stopPropagation();
    initAudio();
    successClicks++;

    message.textContent = "–ú–æ–ª–æ–¥–µ—Ü! –°–º–æ–∂–µ—à—å –µ—â—ë?";
    playSound('success');

    const size = Math.max(10, mainButton.offsetWidth * 0.9);
    mainButton.style.width = size + 'px';
    mainButton.style.height = size + 'px';

    const currentFont = parseFloat(mainButton.style.fontSize || 16);
    mainButton.style.fontSize = Math.max(0, currentFont * 0.85) + 'px';

    mainButton.style.background = '#00c853';
    setTimeout(() => {
      mainButton.style.background = '#ffeb3b';
    }, 150);

    velX *= 1.15;
    velY *= 1.15;
  });

  function formatMinutes(m) {
    if (m % 10 === 1 && m % 100 !== 11) return "–º–∏–Ω—É—Ç–∞";
    if ([2,3,4].includes(m % 10) && ![12,13,14].includes(m % 100)) return "–º–∏–Ω—É—Ç—ã";
    return "–º–∏–Ω—É—Ç";
  }

  workButton.addEventListener('click', (e) => {
    e.stopPropagation();
    const seconds = Math.floor((Date.now() - startTime) / 1000);
    saveRecords(seconds);

    const attempts = missClicks + successClicks;
    const accuracy = attempts === 0 ? 0 : (successClicks / attempts) * 100;

    stats.innerHTML = `
      <div>
        <h2>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h2>
        <p>–ú–ò–ú–û: ${missClicks}</p>
        <p>–ü–û–ü–ê–õ: ${successClicks}</p>
        <p>–¢–æ—á–Ω–æ—Å—Ç—å: ${accuracy.toFixed(1)}%</p>
        <hr>
        <h3>üèÜ –†–µ–∫–æ—Ä–¥—ã</h3>
        <p>–ú–∞–∫—Å. –ø–æ–ø–∞–¥–∞–Ω–∏–π: ${records.maxHits}</p>
        <p>
          –†–µ–∫–æ—Ä–¥ –≤—Ä–µ–º–µ–Ω–∏:
          ${Math.floor(records.maxTime/60)} ${formatMinutes(Math.floor(records.maxTime/60))},
          ${records.maxTime % 60} —Å–µ–∫—É–Ω–¥
        </p>
        <p>–õ—É—á—à–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å: ${(records.bestAccuracy * 100).toFixed(1)}%</p>
        <hr>
        <p>
          –¢—ã –±–µ—Å–ø–æ–ª–µ–∑–Ω–æ –ø–æ—Ç—Ä–∞—Ç–∏–ª
          ${Math.floor(seconds/60)} ${formatMinutes(Math.floor(seconds/60))},
          ${seconds % 60} —Å–µ–∫—É–Ω–¥
        </p>
        <p style="opacity:.6">–ö–ª–∏–∫–Ω–∏ –∫—É–¥–∞ —É–≥–æ–¥–Ω–æ, —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å –∑–∞–Ω–æ–≤–æ</p>
      </div>
    `;

    stats.style.display = 'flex';
  });

  stats.addEventListener('click', () => location.reload());

  animate();
});
</script>

</body>
</html>
